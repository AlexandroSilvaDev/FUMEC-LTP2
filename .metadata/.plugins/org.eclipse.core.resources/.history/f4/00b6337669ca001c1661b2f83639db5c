package LTP2_Lista_7;
import java.util.*;

/*
 Exercício 5.3 - Fazer um programa em Java para calcular uma conta telefônica. Serão digitadas via 
teclado o HORÁRIO INICIAL e o HORÁRIO FINAL de cada ligação. Calcular e imprimir o CUSTO de 
cada chamada de acordo com a tabela abaixo:

______________________________________________
| Intervalo de horário  |   Custo do minuto  |
----------------------------------------------
|    00:00 ás 05:59     |      R$ 0,10       |
----------------------------------------------
|    06:00 às 07:59     |      R$ 0,15       |
----------------------------------------------
|    08:00 às 17:59     |      R$ 0,20       |
----------------------------------------------
|    18:00 às 23:59     |      R$ 0,15       |
----------------------------------------------

Obs: 
- Receber os horários em variável do tipo String no formato HH:MM. Exemplo: "10:30";
- Imprimir o valor TOTAL DA CONTA TELEFÔNICA; 
- Considerar que as ligações sempre ocorrem dentro do mesmo dia;
- Considerar o valor do minuto relativo a HORÁRIO INICIAL da chamada para calcular o CUSTO da 
chamada. Ex: se a chamada começou as 06:30, o valor do minuto para toda a chamada será R$0,15 
independente de quanto tempo durar a chamada;
- Criar um método de nome horaEhValida que deverá receber como parâmetro uma hora no formato 
HH:MM e consistir se HH está entre 0 e 23 e MM está entre 0 e 59. Caso afirmativo, o método deverá 
retornar o valor TRUE, caso negativo o método deverá retornar o valor FALSE.
- Criar uma consistência para que o HORÁRIO FINAL da chamada seja sempre maior que o HORÁRIO 
INICIAL. 
- Adote um Flag para encerrar a entrada de dados.
 */

public class Exercício_5_3 {

	public static void main(String[] args) {
		
		Scanner leia = new Scanner(System.in);
		String horarioInicial;
		String horarioFinal;
		String parametroHora;
		float custoChamada = 0;
		float custoTotalChamadas = 0;
		int finalMenorInicial;
		int horaInicial = 0, minutoInicial = 0, horaFinal = 0, minutoFinal = 0;
		
		do {
			do {
				do {
					System.out.println("Digite o horário de início (HH:MM) da chamada (FIM para encerrar): ");
					horarioInicial = leia.next();
					
					if ( horarioInicial.equalsIgnoreCase("FIM") ) {
						break;
					}
				} while ( ! validarHorarios(horarioInicial) );
				do {
					System.out.println("Digite o horário de término (HH:MM) da chamada: ");
					horarioFinal = leia.next();
					
					if ( horarioFinal.equalsIgnoreCase("FIM") ) {
						break;
					}
				} while ( ! validarHorarios(horarioFinal) );
				
				if ( horarioInicial.equalsIgnoreCase("FIM") ) {
					break;
				}
				
				horaInicial = Integer.parseInt( horarioInicial.substring( 0 , 2 ));
				minutoInicial = Integer.parseInt( horarioInicial.substring( 3 ));
				horaFinal = Integer.parseInt( horarioFinal.substring( 0 , 2 ));
				minutoFinal = Integer.parseInt( horarioFinal.substring( 3 ));
				
				finalMenorInicial = 0;
				if ( horaFinal < horaInicial ) 
				{
					System.out.println("A hora de término deve ser maior que a hora de início da chamada!");
					finalMenorInicial = 1;
				} 
				else if ( horaFinal == horaInicial ) 
				{
					if ( minutoFinal < minutoInicial ) 
					{
						System.out.println("A hora de término deve ser maior que a hora de início da chamada!");
						finalMenorInicial = 1;
					}
				}
			} while ( finalMenorInicial == 1 );
			
			if ( horarioInicial.equalsIgnoreCase("FIM") ) 
			{
				System.out.println("Veja agora o valor total da conta telefônica: \n");
				break;
			}
			
			if ( ( horaInicial >= 0 && minutoInicial >= 0 ) && ( horaInicial <= 5 && minutoInicial <= 59 ) ) 
			{
				custoChamada = ((( horaFinal - horaInicial) * 60 ) + ( minutoFinal - minutoInicial )) * 0.10f;
			} 
			else if ( ( horaInicial >= 6 && minutoInicial >= 0 ) && ( horaInicial <= 7 && minutoInicial <= 59 ) ) 
			{
				custoChamada = ((( horaFinal - horaInicial) * 60 ) + ( minutoFinal - minutoInicial )) * 0.15f;
			} 
			else if ( ( horaInicial >= 8 && minutoInicial >= 0 ) && ( horaInicial <= 17 && minutoInicial <= 59 ) ) 
			{
				custoChamada = ((( horaFinal - horaInicial) * 60 ) + ( minutoFinal - minutoInicial )) * 0.20f;
			} 
			else if ( ( horaInicial >= 18 && minutoInicial >= 0 ) && ( horaInicial <= 23 && minutoInicial <= 59 ) ) 
			{
				custoChamada = ((( horaFinal - horaInicial) * 60 ) + ( minutoFinal - minutoInicial )) * 0.15f;
			}
			custoTotalChamadas = custoTotalChamadas + custoChamada;
			
			System.out.println("O valor da chamada é: " + custoChamada + "\n");
		} while ( true );
		System.out.println(custoTotalChamadas);
	}
	public static boolean validarHorarios ( String parametroHora ) {
		
		int hora, minuto;
		boolean horarioValido;
		
		horarioValido = false;
		try {
			hora = Integer.parseInt( parametroHora.substring( 0 , 2 ));
			minuto = Integer.parseInt( parametroHora.substring( 3 ));
			
			if (( hora >= 0 && hora <= 23 ) && ( minuto >= 0  && minuto <= 59 )) {
				horarioValido = true;
			} else {
				System.out.println("Hora digitada inválida!\n");
			}
		} catch ( NumberFormatException E ) {
			System.out.println("\nO texto digitado não pode ser convertido em número!");
		}
		
		return horarioValido;
	}
}
